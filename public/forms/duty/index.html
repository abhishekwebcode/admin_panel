<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <link href="../css/forms.css" rel="stylesheet" type="text/css">
</head>

<body>

    <form id='iframe-form'>

        <section class="attachment-section section-block mdc-layout-grid">
            <div class="mdc-layout-grid__inner">
                <div class="mdc-layout-grid__cell--span-4-phone mdc-layout-grid__cell--span-4-tablet mdc-layout-grid__cell--span-6-desktop">
                    <div class="employee-choose-container">

                        <div class="search-container">
                            <div class="mdc-text-field mdc-text-field--with-leading-icon" data-mdc-auto-init="MDCTextField" id='employee-search-field'>
                                <i class="material-icons mdc-text-field__icon">search</i>
                                <input class="mdc-text-field__input" id="name-input" required data-field='Name'>
                                <div class="mdc-line-ripple"></div>
                                <label for="name-input" class="mdc-floating-label">Search</label>
                            </div>
                        </div>
                        <ul class="mdc-list mdc-list--two-line" id='employee-list' role="group" aria-label="List with checkbox items">

                        </ul>
                    </div>
                    <div class="action-button-container">
                        <div class="submit-button-cont">
                            <button class="mdc-button mdc-button--raised submit-btn" data-mdc-auto-init="MDCRipple"
                                type="button" id='confirm-employees-btn'>
                                <div class="mdc-button__ripple"></div>
    
                                <span class="mdc-button__label">Next</span>
                            </button>
    
                        </div>
                    </div>
                </div>
                <div class="hidden mdc-layout-grid__cell--span-4-phone mdc-layout-grid__cell--span-4-tablet mdc-layout-grid__cell--span-6-desktop duty-details">
                    <div class="text-field-block">
                        <div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
                            <input class="mdc-text-field__input" required data-field='Supervisor' type="tel">
                            <div class="mdc-line-ripple"></div>
                            <label for="name-input" class="mdc-floating-label">Supervisor</label>
                        </div>
                    </div>
                    <div class="schedule-container" data-schedule-name="Duty">
                        <div class="text-field-block">
                            <div class='inline-flex' data-schedule-type='start'>
                                <div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
                                    <input class="mdc-text-field__input" required  type="date">
                                    <div class="mdc-line-ripple"></div>
                                    <label  class="mdc-floating-label">Start date</label>
                                </div>
                                <div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
                                    <input class="mdc-text-field__input" required  type="time">
                                    <div class="mdc-line-ripple"></div>
                                    <label  class="mdc-floating-label">Start time</label>
                                </div>
                            </div>
                        </div>
                        <div class="text-field-block">
                            <div class='inline-flex' data-schedule-type='end'>
                                <div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
                                    <input class="mdc-text-field__input" required  type="date">
                                    <div class="mdc-line-ripple"></div>
                                    <label  class="mdc-floating-label">End date</label>
                                </div>
                                <div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
                                    <input class="mdc-text-field__input" required  type="time">
                                    <div class="mdc-line-ripple"></div>
                                    <label  class="mdc-floating-label">End time</label>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="text-field-block">
                        <div class="mdc-select" data-type="Duty Type">
                            <div class="mdc-select__anchor demo-width-class">
                              <i class="mdc-select__dropdown-icon"></i>
                              <div class="mdc-select__selected-text"></div>
                              <span class="mdc-floating-label">Duty type</span>
                              <div class="mdc-line-ripple"></div>
                            </div>
                          
                            <div class="mdc-select__menu mdc-menu mdc-menu-surface">
                              <ul class="mdc-list">
                                <!-- <li class="mdc-list-item" data-value="True">
                                 
                                </li> -->
                              </ul>
                            </div>
                          </div>
                    </div>
                    <div class="action-button-container">
                        <div class="submit-button-cont">
                            <button class="mdc-button mdc-button--raised submit-btn" data-mdc-auto-init="MDCRipple"
                                type="button" id='confirm-duty-details-btn'>
                                <div class="mdc-button__ripple"></div>
    
                                <span class="mdc-button__label">Next</span>
                            </button>
    
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="form-actionable section-block">
            <div class="form-buttons">
                <button class="mdc-button" type="button" data-mdc-auto-init="MDCRipple" id='cancel-form'>
                    CANCEL
                </button>
                <input type='submit' class='mdc-button mdc-button--raised' value='SAVE' data-mdc-auto-init="MDCRipple">
            </div>
        </section>
    </form>

    <script src="../js/forms.js"></script>
    <script>
        let template = ''
        const employeeSearchField = new mdc.textField.MDCTextField(document.getElementById('employee-search-field'))
        const employeeList = new mdc.list.MDCList(document.getElementById('employee-list'));
        const confirmEmployeesBtn = document.getElementById('confirm-employees-btn')
        function init(dataObject, isCreate,) {
            template = dataObject.template;
            initEmployeeAdd(dataObject);

            
        }


        function initEmployeeAdd(dataObject){
            employeeSearchField.input_.addEventListener('input',function(evt){
                const inputValue = evt.target.value.trim();
                if(!inputValue) return
                initializeEmployeeSearch(inputValue.toLowerCase(),dataObject.data.employees)
            })
            loadEmployees(dataObject.data.employees);
            confirmEmployeesBtn.addEventListener('click',function(){
                console.log(employeeList);

                // template.attachment.Include = 
                initDutyDetailsAdd(dataObject);
            })
        }

        function initializeEmployeeSearch(inputValue,employees) {
            employeeList.listElements.forEach(function(li){
                if(li.dataset.name.indexOf(inputValue) > -1 || li.dataset.number.indexOf(inputValue) > -1) {
                    li.classList.remove('hidden')
                }
                else {
                    li.classList.add('hidden')
                }
            })
        }

        function loadEmployees(employees) {
            employees.forEach(function(employee,index){
                const number = employee.attachment['Phone Number'].value;
                const name = employee.attachment.Name.value
                const li = checkboxLi(name || number ,index,number);
                li.dataset.number = number;
                li.data.name = name;
                employeeList.root_.appendChild(li)
            })
        }

        function initDutyDetailsAdd(dataObject) {
            document.querySelector('.duty-details').classList.remove('hidden');
            const supervisorField = new mdc.textField.MDCTextField
        }
    </script>
</body>

</html>